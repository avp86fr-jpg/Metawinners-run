<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>🚀 MetaWin — Tribute Slots (Creators on X)</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap" rel="stylesheet">
<style>
  :root{
    --neon-a:#00f6ff;
    --neon-b:#08a6ff;
    --bg:#020204;
    --card:#0b0b0c;
  }
  html,body{height:100%;margin:0;font-family:'Orbitron',sans-serif;background:radial-gradient(1200px 800px at 10% 10%, rgba(0,255,255,0.02), transparent), var(--bg); color:#eafcff; text-align:center; overflow:auto}
  header{padding:22px 12px 8px;display:flex;flex-direction:column;align-items:center;gap:6px;position:sticky;top:0;background:linear-gradient(180deg, rgba(2,2,4,0.6), rgba(2,2,4,0.4));backdrop-filter: blur(6px);}
  header h1{margin:0;color:var(--neon-a);font-size:clamp(1.6rem,3.6vw,2.4rem); text-shadow:0 0 18px rgba(0,255,255,0.12)}
  header .sub{color:#dff;opacity:0.95;font-size:0.95rem}
  #splash{
    position:fixed; inset:0; z-index:999; display:flex; align-items:center; justify-content:center; flex-direction:column;
    background: linear-gradient(180deg, rgba(0,8,20,0.85), rgba(0,0,0,0.94));
    padding:18px;
  }
  #splash .title{ font-size:clamp(2.2rem,6vw,4.6rem); color:var(--neon-a); margin:6px 0 8px; text-shadow:0 0 40px rgba(0,240,255,0.12) }
  #splash .desc{ max-width:900px; color:#dff; opacity:0.95; margin-bottom:18px; font-size:1.02rem }
  #tribute { display:grid; grid-template-columns: repeat(auto-fit,minmax(88px,1fr)); gap:12px; width:min(1080px,92%); margin:10px auto; align-items:center; justify-items:center; }
  .creator { display:flex;flex-direction:column;align-items:center; gap:8px; color:#dff; font-size:0.88rem }
  .creator img{ width:88px;height:88px;border-radius:16px;border:2px solid rgba(0,255,255,0.06); object-fit:cover; box-shadow: 0 6px 22px rgba(0,0,0,0.5); background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(0,0,0,0.06)) }
  .reel-wrap{ display:flex; gap:clamp(18px,4vw,48px); justify-content:center; align-items:center; padding:22px; margin:26px auto; border-radius:18px; max-width:1200px; border:2px solid rgba(0,255,255,0.04); background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.02)); }
  .reel{ flex:1 1 0; max-width:340px; aspect-ratio:1/1.05; border-radius:16px; background:linear-gradient(180deg,var(--card), #0a0a0a); display:flex; align-items:center; justify-content:center; overflow:hidden; border:3px solid rgba(0,255,255,0.08); transition:transform .14s ease, box-shadow .14s ease; }
  .reel img{ max-width:88%; max-height:88%; object-fit:contain; border-radius:12px }
  .reel.spinning{ transform: translateY(-6px); animation: reelGlow .9s infinite alternate; }
  @keyframes reelGlow{ from{ box-shadow:0 18px 36px rgba(0,255,255,0.06)} to{ box-shadow:0 38px 120px rgba(0,150,255,0.12)} }
  #controls{ display:flex; gap:12px; justify-content:center; align-items:center; margin-top:8px; flex-wrap:wrap; padding:8px 12px }
  .btn{ cursor:pointer; border-radius:12px; border:0; padding:12px 22px; font-size:1rem; background:linear-gradient(90deg,var(--neon-a),var(--neon-b)); color:#001; box-shadow:0 8px 30px rgba(0,255,255,0.06); transition: transform .08s }
  .btn:active{ transform:scale(.98) }
  #result{ margin-top:12px; min-height:1.2em; font-size:clamp(1rem,1.6vw,1.2rem); color:#eaffff }
  footer{ margin:28px 0 56px; color:var(--neon-a) }

  /* responsive tweaks */
  @media (max-width:720px){
    .creator img{ width:72px;height:72px }
    .reel-wrap{ gap:10px; padding:12px }
    .reel{ max-width:220px }
  }
</style>
</head>
<body>
  <div id="splash" role="dialog" aria-modal="true">
    <div class="title">Tribute to MetaWinners Creators on X</div>
    <div class="desc">This landing page celebrates creators who've been actively tweeting about MetaWin. Their profile pictures are loaded below and used as slot symbols — a small tribute to the community. Click "Enter" to spin the PFP-powered reels.</div>

    <div id="tribute" aria-live="polite">Loading creators…</div>

    <button id="enterGame" class="btn" style="margin-top:18px">Enter</button>
  </div>

  <header>
    <h1>🚀 Metawinners — Creator Slots</h1>
    <div class="sub">PFP-powered reels — a tribute to creators who champion MetaWin on X</div>
  </header>

  <main>
    <div class="reel-wrap" aria-hidden="false">
      <div class="reel" id="r0">🎯</div>
      <div class="reel" id="r1">🎯</div>
      <div class="reel" id="r2">🎯</div>
    </div>

    <div id="controls" role="region" aria-label="slot controls">
      <button id="spin" class="btn">SPIN</button>
      <button id="addCredit" class="btn">+10 Credits</button>
      <button id="mute" class="btn">🔊 Sound</button>
    </div>

    <div id="result" role="status" aria-live="polite"></div>
  </main>

  <canvas id="confettiCanvas"></canvas>
  <footer>Built as a community tribute — links open on X.</footer>

<script>
/*
  How this works:
  - 'creatorHandles' holds 30 X handles discovered tweeting about MetaWin / MetaWinners.
  - We load their profile images through unavatar.io (public avatar proxy) and add them to 'combinedSymbols'.
  - The reels display those images as tokens; a tribute grid is shown on the splash.
  - If an avatar fails, we fallback to a DiceBear identicon so the reels always have an image.
*/

/* ---------- curated handles (30) ---------- 
   These were found active in MetaWin conversations on X; you can edit this list.
*/
const creatorHandles = [
  "Skelhorn",
  "Meta_Winners",
  "metawin",
  "DarkSkyWeb3",
  "teksmeyt",
  "ShinyNfts",
  "Masaronii",
  "Nightmare27987",
  "baseonethl2",
  "0x_Ckrown",
  "rektonomist_",
  "iDaryAlAli",
  "WinUnionINA",
  "WINterSBP_",
  "winmetawin0825",
  "metawinhq",
  "Masaroni",        // similar names appear in the community
  "ler_oyy",
  "1996_pt",
  "JayM9x",
  "0xDREZ",
  "AkSmall24",
  "0xDREZ",         // duplicate safe-guarded later
  "0x_Ckrown",      // duplicate safe-guarded later
  "cryptocomet10",
  "kobraboy_eth",
  "thomaslpb",
  "judenxt",
  "gagain_jake0",
  "Dan_Donoghue_"
];

/* ---------- runtime state ---------- */
const emojiSymbols = ["🍒","💎","7️⃣","🍀","⭐"];
let combinedSymbols = emojiSymbols.map(s=>({type:'emoji', v:s}));
let credits = 100;
let muted = false;

const reels = [document.getElementById('r0'), document.getElementById('r1'), document.getElementById('r2')];
const creditEl = document.getElementById('creditValue'); // not used here; we show credits via result area for simplicity
const resultEl = document.getElementById('result');

/* ---------- helpers to fetch avatar (no API key) ---------- */
function avatarProxyUrl(handle){
  // unavatar.io supports multiple providers and returns the user's current avatar
  // format: https://unavatar.io/twitter/<handle>?size=512
  // It's public and convenient for quick PFP pulls.
  return `https://unavatar.io/twitter/${encodeURIComponent(handle)}?size=512`;
}
function dicebearFallback(seed){
  // deterministic fallback SVG PNG via dicebear (no CORS issue)
  return `https://api.dicebear.com/7.x/thumbs/png?seed=${encodeURIComponent(seed)}&size=512`;
}

/* ---------- preload avatars and build tribute grid ---------- */
async function loadCreatorsPFPs(){
  const tribute = document.getElementById('tribute');
  tribute.innerHTML = '';
  const seen = new Set();

  // ensure only unique handles and limit to 30
  const uniqueHandles = [];
  for(const h of creatorHandles){
    const hn = (h||'').trim();
    if(!hn) continue;
    if(seen.has(hn.toLowerCase())) continue;
    seen.add(hn.toLowerCase());
    uniqueHandles.push(hn);
    if(uniqueHandles.length>=30) break;
  }

  // Try to load each avatar; add to combinedSymbols when ready.
  for(const handle of uniqueHandles){
    const imgUrl = avatarProxyUrl(handle);
    const card = document.createElement('div'); card.className='creator';
    const link = document.createElement('a'); link.href = `https://x.com/${handle}`; link.target='_blank'; link.rel='noopener noreferrer';
    const name = document.createElement('div'); name.textContent='@'+handle; name.style.fontSize='0.86rem'; name.style.opacity='0.95';
    const img = document.createElement('img');

    // lazy loading & crossOrigin to increase chance of proper load
    img.loading = 'lazy';
    img.crossOrigin = 'anonymous';
    img.alt = handle + ' avatar';
    img.src = imgUrl;

    // attach placeholders while loading
    card.appendChild(img);
    card.appendChild(link);
    link.appendChild(name);
    tribute.appendChild(card);

    // attempt to push into symbols when loaded; otherwise fallback
    await new Promise(resolve=>{
      let settled=false;
      // success
      img.onload = () => {
        if(settled) return; settled=true;
        combinedSymbols.push({ type:'img', v: img.src, handle });
        resolve();
      };
      // error -> fallback to dicebear
      img.onerror = () => {
        if(settled) return; settled=true;
        const fb = dicebearFallback(handle);
        img.src = fb;
        img.onload = () => {
          combinedSymbols.push({ type:'img', v: img.src, handle });
          resolve();
        };
        img.onerror = () => {
          // last fallback to emoji
          combinedSymbols.push({ type:'emoji', v: '⭐' });
          resolve();
        };
      };
      // safety timeout: if neither fires in 4s, fallback
      setTimeout(()=>{
        if(settled) return; settled=true;
        if(!img.src){ img.src = dicebearFallback(handle); combinedSymbols.push({ type:'img', v: img.src, handle }); }
        resolve();
      }, 4000);
    });
  }

  // visible signal: how many PFP images added
  const imgCount = combinedSymbols.filter(s=>s.type==='img').length;
  console.log('PFPs loaded into symbol pool:', imgCount);

  // small UX: if tribute list is short, append a helper note
  if(uniqueHandles.length===0){
    tribute.innerHTML = '<div style="grid-column:1/-1;color:#dff;opacity:0.9">No creators found — paste handles into the code or give me a list and I’ll embed them.</div>';
  }
}

/* ---------- audio init (lightweight) ---------- */
let audioCtx=null; let buffers={};
const soundFiles = {
  spin: "https://assets.mixkit.co/sfx/preview/mixkit-casino-slot-machine-spinning-1935.mp3",
  win:  "https://assets.mixkit.co/sfx/preview/mixkit-winning-chimes-2015.mp3"
};
async function initAudio(){
  if(audioCtx) return;
  try{
    audioCtx = new (window.AudioContext||window.webkitAudioContext)();
    // fetch spin only (small) and decode
    const r = await fetch(soundFiles.spin);
    const ab = await r.arrayBuffer();
    buffers.spin = await audioCtx.decodeAudioData(ab.slice(0));
    // optional: prefetch win sound later
    fetch(soundFiles.win).then(r=>r.arrayBuffer()).then(b=>audioCtx.decodeAudioData(b)).then(decoded=>buffers.win=decoded).catch(()=>{});
  }catch(e){ console.warn('Audio init failed', e); audioCtx=null; }
}
function playSound(name){
  if(muted || !audioCtx || !buffers[name]) return;
  const s = audioCtx.createBufferSource();
  s.buffer = buffers[name];
  s.connect(audioCtx.destination);
  s.start(0);
}
["click","keydown","touchstart"].forEach(evt => window.addEventListener(evt, ()=>initAudio(), { once:true }));

/* ---------- reel logic ---------- */
function setReel(reel, token){
  if(token.type==='img'){
    reel.innerHTML = `<img src="${token.v}" alt="${token.handle ? token.handle : 'pfp'}">`;
  } else {
    reel.textContent = token.v;
  }
}
function randomToken(){
  const idx = Math.floor(Math.random()*combinedSymbols.length);
  return combinedSymbols[idx];
}
function spinReel(reel, final, steps=24){
  return new Promise(resolve=>{
    let i=0;
    reel.classList.add('spinning');
    function tick(){
      setReel(reel, randomToken());
      i++;
      if(i>=steps){
        setTimeout(()=>{ setReel(reel, final); reel.classList.remove('spinning'); resolve(final); }, 180);
      } else {
        setTimeout(tick, 60 + i*3);
      }
    }
    tick();
  });
}

/* ---------- game actions ---------- */
async function spin(){
  if(credits<=0){ resultEl.textContent = 'No credits left — add more!'; return; }
  credits--; resultEl.textContent='Spinning…'; playSound('spin');
  // pick finals from pool
  const finals = [ randomToken(), randomToken(), randomToken() ];
  const [a,b,c] = await Promise.all([
    spinReel(reels[0], finals[0], 24),
    spinReel(reels[1], finals[1], 30),
    spinReel(reels[2], finals[2], 36)
  ]);
  // compare identity (if images, compare src)
  const v0 = a.type+'|'+String(a.v), v1 = b.type+'|'+String(b.v), v2 = c.type+'|'+String(c.v);
  if(v0===v1 && v1===v2){
    resultEl.textContent = '🎉 JACKPOT! +50 credits!';
    credits += 50;
    playSound('win');
    launchConfetti();
  } else {
    resultEl.textContent = 'Try again!';
  }
}

/* ---------- confetti ---------- */
function launchConfetti(){
  const canvas = document.getElementById('confettiCanvas');
  const ctx = canvas.getContext('2d');
  canvas.width = innerWidth; canvas.height = innerHeight;
  const pieces = Array.from({length:120}, () => ({
    x: Math.random()*canvas.width,
    y: Math.random()*canvas.height - canvas.height,
    r: Math.random()*6+4,
    speed: Math.random()*3+2,
    color: `hsl(${Math.random()*360},100%,50%)`
  }));
  let frame=0;
  function loop(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    for(const p of pieces){
      p.y += p.speed;
      if(p.y > canvas.height) p.y = -10;
      ctx.fillStyle = p.color;
      ctx.fillRect(p.x, p.y, p.r, p.r*0.6);
    }
    if(frame++ < 220) requestAnimationFrame(loop);
    else ctx.clearRect(0,0,canvas.width,canvas.height);
  }
  loop();
}

/* ---------- UI hooks ---------- */
document.getElementById('spin').addEventListener('click', spin);
document.getElementById('addCredit').addEventListener('click', ()=>{ credits += 10; resultEl.textContent = `Credits: ${credits}`; });
document.getElementById('mute').addEventListener('click', ()=>{ muted = !muted; document.getElementById('mute').textContent = muted ? '🔇 Muted' : '🔊 Sound'; });
document.getElementById('enterGame').addEventListener('click', ()=>{ document.getElementById('splash').style.display='none'; });

/* ---------- startup: load avatars then enable spins ---------- */
(async function init(){
  resultEl.textContent = 'Loading creators and avatars…';
  await loadCreatorsPFPs();
  // ensure there are at least several image symbols; if not, pad with emoji
  if(combinedSymbols.filter(s=>s.type==='img').length < 6){
    combinedSymbols.push(...["🍒","💎","7️⃣","💰"].map(s=>({type:'emoji',v:s})));
  }
  resultEl.textContent = `Ready — Credits: ${credits}. Click SPIN to play (symbols: ${combinedSymbols.length}).`;
})();
</script>
</body>
</html>
